name: My First Workflow For RG Creation
on: [push]
  # push:
  #   branches:
  #     - main
  #     - feature/*
  
jobs:
  Terraform-Init:
    name: Terraform Init
    runs-on: my-runner
    steps:
    - name: Checkout
      uses: actions/checkout@v5.0.0
      
    - name: Azure Login 
      uses: Azure/login@v2.3.0
      with:
        creds: ${{ secrets.MYAZURECREDENTIALS }}
      
    - name: Terraform init/plan
      run: terraform init
      working-directory: Parent_Module/Dev

  Code-Scaning:
    name: Security Scanning
    runs-on: my-runner
    needs: Terraform-Init
    steps:
    - name: TFlinit Setup
      shell: powershell
      run: |
       $tflintDir = "$env:USERPROFILE\tflint"
       if (Test-Path $tflintDir) {
       Remove-Item $tflintDir -Recurse -Force
       }
       Invoke-WebRequest -Uri "https://github.com/terraform-linters/tflint/releases/latest/download/tflint_windows_amd64.zip" -OutFile "tflint.zip"
       New-Item -ItemType Directory -Path $tflintDir
       Expand-Archive -Path "tflint.zip" -DestinationPath $tflintDir -Force
       $env:Path += ";$tflintDir"
       & "$tflintDir\tflint.exe" --version
    